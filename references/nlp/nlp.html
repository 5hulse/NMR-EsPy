

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>nmrespy.nlp.nlp &#8212; NMR-EsPy  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bizstyle.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="nmrespy.nlp._funcs" href="_funcs.html" />
    <link rel="prev" title="nmrespy.nlp" href="index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="_funcs.html" title="nmrespy.nlp._funcs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="nmrespy.nlp"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">NMR-EsPy  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">nmrespy.nlp</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">nmrespy.nlp.nlp</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <style>
   .grey {color:#808080}
   .red {color:#ff0000}
   .green {color:#008000}
   .blue {color:#0000ff}
   .oscblue {color:#1063e0}
   .oscorange {color:#eb9310}
   .oscgreen {color:#2bb539}
   .oscred {color:#d4200c}
   .regiongreen {color: #7fd47f}
   .regionblue {color: #66b3ff}
</style><section id="module-nmrespy.nlp.nlp">
<span id="nmrespy-nlp-nlp"></span><h1>nmrespy.nlp.nlp<a class="headerlink" href="#module-nmrespy.nlp.nlp" title="Permalink to this headline">¶</a></h1>
<p>Nonlinear programming for generating NMR parameter estiamtes</p>
<dl class="py class">
<dt class="sig sig-object py" id="nmrespy.nlp.nlp.NonlinearProgramming">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">nmrespy.nlp.nlp.</span></span><span class="sig-name descname"><span class="pre">NonlinearProgramming</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'trust_region'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_thold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_thold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_amps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'remove'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'apfd'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/nlp/nlp.html#NonlinearProgramming"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.nlp.nlp.NonlinearProgramming" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for nonlinear programming for determination of spectral parameter
estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – Signal to be considered (unnormalised).</p></li>
<li><p><strong>theta0</strong> (<em>numpy.ndarray</em>) – <p>Initial parameter guess in the following form:</p>
<ul>
<li><p><strong>1-dimensional data:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theta0</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="n">a_1</span><span class="p">,</span> <span class="n">φ_1</span><span class="p">,</span> <span class="n">f_1</span><span class="p">,</span> <span class="n">η_1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">a_2</span><span class="p">,</span> <span class="n">φ_2</span><span class="p">,</span> <span class="n">f_2</span><span class="p">,</span> <span class="n">η_2</span><span class="p">],</span>
    <span class="o">...</span><span class="p">,</span>
    <span class="p">[</span><span class="n">a_m</span><span class="p">,</span> <span class="n">φ_m</span><span class="p">,</span> <span class="n">f_m</span><span class="p">,</span> <span class="n">η_m</span><span class="p">],</span>
<span class="p">])</span>
</pre></div>
</div>
</li>
<li><p><strong>2-dimensional data:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theta0</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="n">a_1</span><span class="p">,</span> <span class="n">φ_1</span><span class="p">,</span> <span class="n">f1_1</span><span class="p">,</span> <span class="n">f2_1</span><span class="p">,</span> <span class="n">η1_1</span><span class="p">,</span> <span class="n">η2_1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">a_2</span><span class="p">,</span> <span class="n">φ_2</span><span class="p">,</span> <span class="n">f1_2</span><span class="p">,</span> <span class="n">f2_2</span><span class="p">,</span> <span class="n">η1_2</span><span class="p">,</span> <span class="n">η2_2</span><span class="p">],</span>
    <span class="o">...</span><span class="p">,</span>
    <span class="p">[</span><span class="n">a_m</span><span class="p">,</span> <span class="n">φ_m</span><span class="p">,</span> <span class="n">f1_m</span><span class="p">,</span> <span class="n">f2_m</span><span class="p">,</span> <span class="n">η1_m</span><span class="p">,</span> <span class="n">η2_m</span><span class="p">],</span>
<span class="p">])</span>
</pre></div>
</div>
</li>
</ul>
</p></li>
<li><p><strong>sw</strong> (<em>[</em><em>float</em><em>] or </em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – The experiment sweep width in each dimension in Hz.</p></li>
<li><p><strong>offset</strong> (<em>[</em><em>float</em><em>] or </em><em>[</em><em>float</em><em>, </em><em>float</em><em>] or </em><em>None</em><em>, </em><em>default: None</em>) – The experiment transmitter offset frequency in Hz. If <cite>None</cite>,
<cite>offset</cite> will be set as <code class="docutils literal notranslate"><span class="pre">data.ndim</span> <span class="pre">*</span> <span class="pre">[0.0]</span></code>.</p></li>
<li><p><strong>sfo</strong> (<em>[</em><em>float</em><em>]</em><em>, </em><em>[</em><em>float</em><em>, </em><em>float</em><em>] or </em><em>None</em><em>, </em><em>default: None</em>) – The experiment transmitter frequency in each dimension in MHz.
This is not necessary, however if it set it to <cite>None</cite>, no conversion
of frequencies from Hz to ppm will be possible!</p></li>
<li><p><strong>start_point</strong> (<em>int</em><em>, </em><em>default: 0</em>) – The first timepoint sampled, in units of
<img class="math" src="../../_images/math/73c0292a780912fed0f96bc618a2680f51829349.png" alt="\Delta t = 1 / f_{\mathrm{sw}}"/></p></li>
<li><p><strong>phase_variance</strong> (<em>bool</em><em>, </em><em>default: True</em>) – <p>Specifies whether or not to include the variance of oscillator
phases into the NLP routine. The fiedlity (cost function) is
given by:</p>
<ul>
<li><p><cite>phase_variance</cite> set to <cite>False</cite>:</p>
<div class="math">
<p><img src="../../_images/math/f79294c21881ec3a5feba5529ad11176c7aabe9c.png" alt="\mathcal{F}\left(\boldsymbol{\theta}\right) =
\left\lVert \boldsymbol{Y} - \boldsymbol{X} \right\rVert_2^2"/></p>
</div></li>
<li><p><cite>phase_variance</cite> set to <cite>True</cite>:</p>
<div class="math">
<p><img src="../../_images/math/d8729bd0c9aee1bb34cd19e1de5f783faa501bd7.png" alt="\mathcal{F}\left(\boldsymbol{\theta}\right) =
\left\lVert \boldsymbol{Y} - \boldsymbol{X} \right
\rVert_2^2 + \mathrm{Var}\left(\boldsymbol{\phi}\right)"/></p>
</div></li>
</ul>
</p></li>
<li><p><strong>method</strong> (<em>'trust_region'</em><em> or </em><em>'lbfgs'</em><em>, </em><em>default: 'trust_region'</em>) – Optimisation algorithm to use. These utilise
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">scipy.optimise.minimise</a>, with
the method either being <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-trustconstr.html#optimize-minimize-trustconstr">trust-constr</a>, or
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-lbfgsb.html#optimize-minimize-lbfgsb">L-BFGS-B</a>.</p></li>
<li><p><strong>bound</strong> (<em>bool</em><em>, </em><em>default: False</em>) – <p>Specifies whether or not to bound the parameters during optimisation.
Bounds are given by:</p>
<ul>
<li><p><img class="math" src="../../_images/math/fa5fd6230281c8c6524310c9287f398e6dd4d523.png" alt="0 \leq a_m \leq \infty"/></p></li>
<li><p><img class="math" src="../../_images/math/f174ca3f0e9cf7735fe7af5e8fb4c418ab0f4448.png" alt="-\pi &lt; \phi_m \leq \pi"/></p></li>
<li><p><img class="math" src="../../_images/math/e767e8ad5a336fa2896cb8dd04d5d4ba2fa69885.png" alt="-f_{\mathrm{sw}} / 2 + f_{\mathrm{off}} \leq f_m \leq        f_{\mathrm{sw}} / 2 + f_{\mathrm{off}}"/></p></li>
<li><p><img class="math" src="../../_images/math/3dcf83342094e34a601590bdf5b7cf9888350dd9.png" alt="0 \leq \eta_m \leq \infty"/></p></li>
</ul>
<p><img class="math" src="../../_images/math/307409f0194d9386b4aff3ef70fb0b31ab9d2c86.png" alt="(\forall m \in \{1, \cdots, M\})"/></p>
</p></li>
<li><p><strong>max_iterations</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>default: None</em>) – A value specifiying the number of iterations the routine may run
through before it is terminated. If <cite>None</cite>, the default number
of maximum iterations is set (<cite>100</cite> if <cite>method</cite> is <cite>‘trust_region’</cite>,
and <cite>500</cite> if <cite>method</cite> is <cite>‘lbfgs’</cite>).</p></li>
<li><p><strong>amp_thold</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>default: None</em>) – A value that imposes a threshold for deleting oscillators of
negligible ampltiude. If <cite>None</cite>, does nothing. If a float, oscillators
with amplitudes satisfying <img class="math" src="../../_images/math/724d35310d0c2fd2abd48979c57814c202f3dd22.png" alt="a_m &lt; a_{\mathrm{thold}}
\lVert \boldsymbol{a} \rVert_2"/> will be removed from the
parameter array, where <img class="math" src="../../_images/math/876e6b864ac0c3555d0e755739c6acffd852560a.png" alt="\lVert \boldsymbol{a} \rVert_2"/>
is the Euclidian norm of the vector of all the oscillator amplitudes.
It is advised to set <cite>amp_thold</cite> at least a couple of orders of
magnitude below 1.</p></li>
<li><p><strong>freq_thold</strong> (<em>float</em><em> or </em><em>None</em>) – <p>If <cite>None</cite>, does nothing. If a float, oscillator pairs with
frequencies satisfying
<img class="math" src="../../_images/math/4e3a6ffc19d9be719efcb6e503b9b41b582877ec.png" alt="\lvert f_m - f_p \rvert &lt; f_{\mathrm{thold}}"/> will be
removed from the parameter array. A new oscillator will be included
in the array, with parameters:</p>
<ul>
<li><p>amplitude: <img class="math" src="../../_images/math/87f5d91caa16da31a89f9087342b794c85cea611.png" alt="a = a_m + a_p"/></p></li>
<li><p>phase: <img class="math" src="../../_images/math/6bc24e42744ff70a74a304ab83e2f1af5f2a5795.png" alt="\phi = \left(\phi_m + \phi_p\right) / 2"/></p></li>
<li><p>frequency: <img class="math" src="../../_images/math/dab75f52c4905438a18cdfd0fe406fa339a8dec9.png" alt="f = \left(f_m + f_p\right) / 2"/></p></li>
<li><p>damping: <img class="math" src="../../_images/math/f999a19690afa1e8dc12c89e0895fcf0337e2760.png" alt="\eta = \left(\eta_m + \eta_p\right) / 2"/></p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>NOT IMPLEMENTED YET</p>
</div>
</p></li>
<li><p><strong>negative_amps</strong> (<em>'remove'</em><em> or </em><em>'flip_phase'</em><em>, </em><em>default: 'remove'</em>) – <p>Indicates how to treat oscillators which have gained negative
amplitudes during the optimisation.</p>
<ul>
<li><p><cite>’remove’</cite> will result in such oscillators being purged from
the parameter estimate. The optimisation routine will the be
re-run recursively until no oscillators have a negative amplitude.</p></li>
<li><p><cite>’flip_phase’</cite> will retain oscillators with negative amplitudes,
but the the amplitudes will be multiplied by -1, and a π radians
phase shift will be applied to these oscillators.</p></li>
</ul>
</p></li>
<li><p><strong>fprint</strong> (<em>bool</em><em>, </em><em>default: True</em>) – If <cite>True</cite>, the method provides information on progress to
the terminal as it runs. If <cite>False</cite>, the method will run silently.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The two optimisation algorithms (specified by <cite>method</cite>) primarily
differ in how they treat the calculation of the matrix of cost
function second derivatives (called the Hessian). <cite>‘trust_region’</cite>
will calculate the Hessian explicitly at every iteration, whilst
<cite>‘lbfgs’</cite> uses an update formula based on gradient information to
estimate the Hessian. The upshot of this is that the convergence
rate (the number of iterations needed to reach convergence) is
typically better for <cite>‘trust_region’</cite>, though each iteration
typically takes longer to generate. By default, it is advised to
use <cite>‘trust_region’</cite>, however if your guess has a large number
of signals, you may find <cite>‘lbfgs’</cite> performs more effectively.</p>
<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.nlp.nlp.NonlinearProgramming.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'trust_region'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_thold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_thold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_amps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'remove'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'apfd'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/nlp/nlp.html#NonlinearProgramming.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.nlp.nlp.NonlinearProgramming.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise the class instance. Checks that all arguments are
valid</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.nlp.nlp.NonlinearProgramming._check_negative_amps">
<span class="sig-name descname"><span class="pre">_check_negative_amps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/nlp/nlp.html#NonlinearProgramming._check_negative_amps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.nlp.nlp.NonlinearProgramming._check_negative_amps" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines which oscillators (if any) have negative amplitudes, and
removes them, or recasts them with positive amplitude and a 180° phase
shift.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>term</strong> – Used by <code class="xref py py-meth docutils literal notranslate"><span class="pre">_optimise()</span></code> to decide whether to terminate
or re-run the optimisation routine.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.nlp.nlp.NonlinearProgramming._get_active_passive_indices">
<span class="sig-name descname"><span class="pre">_get_active_passive_indices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/nlp/nlp.html#NonlinearProgramming._get_active_passive_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.nlp.nlp.NonlinearProgramming._get_active_passive_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the indices of blocks of the parameter vector that
contain the active and passive parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.nlp.nlp.NonlinearProgramming._get_bounds">
<span class="sig-name descname"><span class="pre">_get_bounds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/nlp/nlp.html#NonlinearProgramming._get_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.nlp.nlp.NonlinearProgramming._get_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a list of bounding constraints to set for each
parameter. The bounds are as follows:</p>
<ul class="simple">
<li><p>amplitudes: 0 &lt; a &lt; ∞</p></li>
<li><p>phases: -π &lt; φ &lt; π</p></li>
<li><p>frequencies: offset - sw/2 &lt; f &lt; offset + sw/2</p></li>
<li><p>damping: 0 &lt; η &lt; ∞</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.nlp.nlp.NonlinearProgramming._get_errors">
<span class="sig-name descname"><span class="pre">_get_errors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/nlp/nlp.html#NonlinearProgramming._get_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.nlp.nlp.NonlinearProgramming._get_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the errors of the estimation result</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.nlp.nlp.NonlinearProgramming._get_slice">
<span class="sig-name descname"><span class="pre">_get_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">osc_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/nlp/nlp.html#NonlinearProgramming._get_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.nlp.nlp.NonlinearProgramming._get_slice" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>list</em>) – Parameter types to be targeted. Valid ints are <cite>0</cite> to <cite>3</cite>
(included) for a 1D signal, and <cite>0</cite> to <cite>5</cite> for a 2D signal</p></li>
<li><p><strong>osc_idx</strong> (<em>list</em><em> or </em><em>None default: None</em>) – Oscillators to be targeted. Can be either <cite>None</cite>, where all
oscillators are indexed, or a list of ints, in order to select
a subset of oscillators. Valid ints are <cite>0</cite> to <cite>self.m - 1</cite>
(included).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>slice</strong> – Array slice.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.nlp.nlp.NonlinearProgramming._merge_active_passive">
<span class="sig-name descname"><span class="pre">_merge_active_passive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/nlp/nlp.html#NonlinearProgramming._merge_active_passive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.nlp.nlp.NonlinearProgramming._merge_active_passive" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the active and passive parameters in vector form, merge to
form the complete parameter vector</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>active_vec</strong> (<em>numpy.ndarray</em>) – Active vector.</p></li>
<li><p><strong>passive_vec</strong> (<em>numpy</em><em>,</em><em>ndarray</em>) – Passive vector.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>merged_vec</strong> – Merged (complete) vector.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.nlp.nlp.NonlinearProgramming._pi_flip">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">_pi_flip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/nlp/nlp.html#NonlinearProgramming._pi_flip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.nlp.nlp.NonlinearProgramming._pi_flip" title="Permalink to this definition">¶</a></dt>
<dd><p>flip array of phases by π radians, ensuring the phases remain in
the range (-π, π]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.nlp.nlp.NonlinearProgramming._run_nlp">
<span class="sig-name descname"><span class="pre">_run_nlp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/nlp/nlp.html#NonlinearProgramming._run_nlp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.nlp.nlp.NonlinearProgramming._run_nlp" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs nonlinear programming</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.nlp.nlp.NonlinearProgramming._shift_offset">
<span class="sig-name descname"><span class="pre">_shift_offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/nlp/nlp.html#NonlinearProgramming._shift_offset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.nlp.nlp.NonlinearProgramming._shift_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Shifts frequencies to center to or displace from 0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>numpy.ndarray</em>) – Full parameter array</p></li>
<li><p><strong>direction</strong> (<em>'center'</em><em> or </em><em>'displace'</em>) – <cite>‘center’</cite> shifts frerquencies such that the central frequency
is set to zero. <cite>‘displace’</cite> moves frequencies away from zero,
to be reflected by offset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.nlp.nlp.NonlinearProgramming._split_active_passive">
<span class="sig-name descname"><span class="pre">_split_active_passive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">merged_vec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/nlp/nlp.html#NonlinearProgramming._split_active_passive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.nlp.nlp.NonlinearProgramming._split_active_passive" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a full vector of parameters, split to form vectors of active
and passive parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>merged_vec</strong> (<em>numpy.ndarray</em>) – Full parameter vector</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>active_vec</strong> (<em>numpy.ndarray</em>) – Active vector.</p></li>
<li><p><strong>passive_vec</strong> (<em>numpy,ndarray</em>) – Passive vector.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.nlp.nlp.NonlinearProgramming.get_errors">
<span class="sig-name descname"><span class="pre">get_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hz'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/nlp/nlp.html#NonlinearProgramming.get_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.nlp.nlp.NonlinearProgramming.get_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain errors of parameters estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>freq_unit</strong> (<em>'hz'</em><em> or </em><em>'ppm'</em><em>, </em><em>default: 'hz'</em>) – The unit of the oscillator frequencies (corresponding to
<code class="docutils literal notranslate"><span class="pre">result[:,</span> <span class="pre">2]</span></code>)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.nlp.nlp.NonlinearProgramming.get_result">
<span class="sig-name descname"><span class="pre">get_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hz'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/nlp/nlp.html#NonlinearProgramming.get_result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.nlp.nlp.NonlinearProgramming.get_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the result of nonlinear programming.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>freq_unit</strong> (<em>'hz'</em><em> or </em><em>'ppm'</em><em>, </em><em>default: 'hz'</em>) – The unit of the oscillator frequencies (corresponding to
<code class="docutils literal notranslate"><span class="pre">result[:,</span> <span class="pre">2]</span></code>)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">nmrespy.nlp</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="_funcs.html"
                        title="next chapter">nmrespy.nlp._funcs</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/references/nlp/nlp.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="_funcs.html" title="nmrespy.nlp._funcs"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="nmrespy.nlp"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">NMR-EsPy  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >nmrespy.nlp</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">nmrespy.nlp.nlp</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Simon Hulse &amp; Mohammadali Foroozandeh.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.1.1.
    </div>
  </body>
</html>