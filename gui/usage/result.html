

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Estimation Result &#8212; NMR-EsPy  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bizstyle.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Reference" href="../../references/index.html" />
    <link rel="prev" title="Estimation Set-up" href="setup.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../references/index.html" title="Reference"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="setup.html" title="Estimation Set-up"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">NMR-EsPy  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >The NMR-EsPy GUI</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Using The GUI</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Estimation Result</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <style>
   .grey {color:#808080}
   .red {color:#ff0000}
   .green {color:#008000}
   .blue {color:#0000ff}
   .oscblue {color:#1063e0}
   .oscorange {color:#eb9310}
   .oscgreen {color:#2bb539}
   .oscred {color:#d4200c}
   .regiongreen {color: #7fd47f}
   .regionblue {color: #66b3ff}
</style><section id="estimation-result">
<h1>Estimation Result<a class="headerlink" href="#estimation-result" title="Permalink to this headline">¶</a></h1>
<p>Once the routine is complete, a new window will load with the following
appearance:</p>
<img alt="../../_images/result_window.png" class="align-center" src="../../_images/result_window.png" />
<p>Featured in the result plot are:</p>
<ul class="simple">
<li><p>The data selected (black).</p></li>
<li><p>Individual peaks that comprise the estimation result
(<span class="oscblue">m</span><span class="oscorange">u</span><span class="oscgreen">l</span><span class="oscred">t</span><span class="oscblue">i</span><span class="oscorange">-</span><span class="oscgreen">c</span><span class="oscred">o</span><span class="oscblue">l</span><span class="oscorange">o</span><span class="oscgreen">u</span><span class="oscred">r</span><span class="oscblue">e</span><span class="oscorange">d</span>).
Each of these is given a numerical label.</p></li>
<li><p>The residual between the data and the model (<span class="grey">grey</span>).</p></li>
</ul>
<section id="tweaking-and-re-optimising-the-result">
<h2>Tweaking and Re-optimising the result<a class="headerlink" href="#tweaking-and-re-optimising-the-result" title="Permalink to this headline">¶</a></h2>
<p>There may be circumstances where you feel that the estimation result has not
succeeded in describing certain aspects of the data well. For example, it may
fit two very closely-separated resonances with a single oscillator.</p>
<p>The <em>Edit Parameter Estimate</em> button provides functionality to manually change
the estimation result. Upon making such changes, the optimiser should be re-run
to achieve a minimisation of the cost function of interest.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This feature is present to fix “glaring” incorrect features of the estimation
result. It is not intended for liberal “fudging” of the result.</p>
</div>
<p>A window with the following appearance will appear after you click
<em>Edit Parameter Estimate</em>:</p>
<img alt="../../_images/edit_parameters_window_1.png" class="align-center" src="../../_images/edit_parameters_window_1.png" />
<p>Each oscillator is listed with its associated parameters. The numerical values
assigned to each oscillator match those in the result figure.</p>
<p>Initially, no oscillators are selected. When this is the case, two buttons
are active: <em>Add</em>, which allows you to add extra oscillators, and <em>Close</em>,
which closes the window.</p>
<p>To select and oscillator, left-click the associated numerical label. This will
highlight the oscillator. Here is an example after oscillator 3 is clicked:</p>
<img alt="../../_images/edit_parameters_window_2.png" class="align-center" src="../../_images/edit_parameters_window_2.png" />
<p>To de-select the oscillator, simply left-click the numerical label again. Two
new buttons are activated when one oscillator is selected: <em>Remove</em>, which will
purge the selected oscillator from the result, and <em>Split</em>, which allows you
to create “child oscillators” with the same cumulative amplitude as the parent.</p>
<p>To select multiple oscillators at a single time, left-click on each oscillator
label whilst holding <code class="docutils literal notranslate"><span class="pre">&lt;Shift&gt;</span></code>:</p>
<img alt="../../_images/edit_parameters_window_3.png" class="align-center" src="../../_images/edit_parameters_window_3.png" />
<p>When more than one oscillator is selected, the <em>Merge</em> button is activated,
along with the Remove button.</p>
<section id="the-add-button">
<h3>The Add Button<a class="headerlink" href="#the-add-button" title="Permalink to this headline">¶</a></h3>
<p>The Add button allows you to add an oscillator with arbitrary parameters to
the estimation result. The main circumstance that this may be useful is when
there is a low-intensity oscillator in the data which the estimation routine
has failed to identify. Extensive use of this button is not advised.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The add button provides exactly the same functionality as
<a class="reference internal" href="../../references/core.html#nmrespy.core.Estimator.add_oscillators" title="nmrespy.core.Estimator.add_oscillators"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_oscillators()</span></code></a>.</p>
</div>
<p>Clicking on the Add button when no oscillators are selected will load the
following window:</p>
<img alt="../../_images/add_window.png" class="align-center" src="../../_images/add_window.png" />
<p>You need to input the desired parameters that make up the oscillator to be
added. Each entry box needs to be validated by pressing <code class="docutils literal notranslate"><span class="pre">&lt;Return&gt;</span></code> after
inputting the desired value:</p>
<ul class="simple">
<li><p>Amplitudes must be positive.</p></li>
<li><p>Phases may be any numerical value. The value you provide will be wrapped
to be in the range <span class="math">\left(-\pi, \pi\right]</span>.</p></li>
<li><p>Frequencies must be within the spectral range of the data considered.</p></li>
<li><p>Damping factors must be positive.</p></li>
</ul>
<p>If you wish to include more than one extra oscillator, click the <em>Add</em> button.
This will append an extra row to the table. When you have a parameter table
with all entry boxes validated (i.e. none of them are red), click <em>Confirm</em>
to append the changes to the result. If you want to quit the window without
making any changes, press <em>Cancel</em>.</p>
</section>
<section id="the-remove-button">
<h3>The Remove Button<a class="headerlink" href="#the-remove-button" title="Permalink to this headline">¶</a></h3>
<p>If one or more oscillators are selected, the Remove button will purge these
from the result.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The add button provides exactly the same functionality as
<a class="reference internal" href="../../references/core.html#nmrespy.core.Estimator.remove_oscillators" title="nmrespy.core.Estimator.remove_oscillators"><code class="xref py py-meth docutils literal notranslate"><span class="pre">remove_oscillators()</span></code></a>.</p>
</div>
</section>
<section id="the-merge-button">
<h3>The Merge Button<a class="headerlink" href="#the-merge-button" title="Permalink to this headline">¶</a></h3>
<p>With more than one oscillator selected, the merge button will remove all
selected oscillators, and create a single oscillator with parameters that
reflect the selected oscillators. The new oscillator’s amplitude will be
the sum of the selected oscillators, and the other parameters will be the
mean of the selected oscillators.</p>
<p>The main use of this is to merge a “superfluous” set of oscillators which
are modelling a single resonance in the data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The add button provides exactly the same functionality as
<a class="reference internal" href="../../references/core.html#nmrespy.core.Estimator.merge_oscillators" title="nmrespy.core.Estimator.merge_oscillators"><code class="xref py py-meth docutils literal notranslate"><span class="pre">merge_oscillators()</span></code></a>.</p>
</div>
</section>
<section id="the-split-button">
<h3>The Split Button<a class="headerlink" href="#the-split-button" title="Permalink to this headline">¶</a></h3>
<p>With one oscillator selected, the Split button will purge the oscillator
and in its place create a series of “child” oscillators.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The add button provides exactly the same functionality as
<a class="reference internal" href="../../references/core.html#nmrespy.core.Estimator.split_oscillator" title="nmrespy.core.Estimator.split_oscillator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">split_oscillator()</span></code></a>.</p>
</div>
<p>The following window loads when you click <em>Split</em>:</p>
<img alt="../../_images/split_window.png" class="align-center" src="../../_images/split_window.png" />
<ul>
<li><p>The <em>Number of oscillators</em> box specifies how many child oscillators
to generate.</p></li>
<li><p>The <em>Frequency separation</em> box specifies how far apart adjacent child
oscillators will be. You can choose the units to be in Hz or ppm. By
default, it is set at 2Hz</p></li>
<li><p>The <em>Amplitude ratio</em> box specifies the relative amplitudes of the
oscillators. A valid input for this box takes the form of <span class="math">n</span>
integers, each separated by a colon, where <span class="math">n</span> is the value in
the <em>Number of oscillators</em> box. By default, this will be set to be
<span class="math">n</span> 1s separated by colons, such that all child oscillators will
have the same amplitude.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are familiar with regular expressions, the value in the Amplitude
ratio box should match <code class="regexp docutils literal notranslate"><span class="pre">^d+(:d+){n}$</span></code>.</p>
</div>
</li>
</ul>
<p>To enact the splitting, click <em>Confirm</em>.</p>
</section>
<section id="re-running-the-optimiser">
<h3>Re-running the Optimiser<a class="headerlink" href="#re-running-the-optimiser" title="Permalink to this headline">¶</a></h3>
<p>If you have made any changes to the estimation result, you will notice that
the bottom right button has changed from <em>Close</em> to <em>Re-run optimiser</em>. As well
as this, the <em>Reset</em> button to the left has been activated. NMR-EsPy does
not allow you to save an estimation result for which the last step of the
process was manual editing of the result. As such, if you wish to enact the
changes made, you have to re-run nonlinear programming with the current result
as the initial guess.</p>
</section>
<section id="undoing-changes">
<h3>Undoing changes<a class="headerlink" href="#undoing-changes" title="Permalink to this headline">¶</a></h3>
<p>If you decide that you want to undo all the changes made in the
<cite>Edit Parameter Estimate</cite> window, simply click the Reset button.</p>
</section>
</section>
<section id="saving-the-result">
<h2>Saving the result<a class="headerlink" href="#saving-the-result" title="Permalink to this headline">¶</a></h2>
<p>Clicking the <em>Save</em> button loads the following window:</p>
<img alt="../../_images/save_window.png" class="align-center" src="../../_images/save_window.png" style="width: 321.5px; height: 764.5px;" />
<section id="result-figure">
<h3>Result Figure<a class="headerlink" href="#result-figure" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>This section is used for specifying whether to save a result figure, and
for customising some simple figure settings.</p>
<ul class="simple">
<li><p><cite>Save Figure</cite> - Whether to save a figure or not.</p></li>
<li><p><cite>Format</cite> - The figure’s file format. Valid options are <code class="docutils literal notranslate"><span class="pre">eps</span></code>, <code class="docutils literal notranslate"><span class="pre">png</span></code>,
<code class="docutils literal notranslate"><span class="pre">pdf</span></code>, <code class="docutils literal notranslate"><span class="pre">jpg</span></code>, <code class="docutils literal notranslate"><span class="pre">ps</span></code> and <code class="docutils literal notranslate"><span class="pre">svg</span></code>.</p></li>
<li><p><cite>Filename</cite> - The name of the file to save the Figure to.</p></li>
<li><p><cite>dpi</cite> - Dots per inch.</p></li>
<li><p><cite>Size (cm)</cite> - The width and height of the figure, in centimeters.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The most up-voted answer to
<a class="reference external" href="https://stackoverflow.com/questions/47633546/relationship-between-dpi-and-figure-size">this Stack Overflow question</a> provides a good
description of the relationship between figure size and dpi.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Beyond specifying the dpi and size of the figure, the GUI does not provide
any means of customising the appearance of the figure in this version.
I intend to provide support of for in a future version.  At the moment,
the only means of customising the figure is to do it by writing a Python
script. I provide an outline of how you can achieve certain customisations
<a class="reference internal" href="../../misc/figure_customisation.html"><span class="doc">here</span></a></p>
</div>
</div></blockquote>
</section>
<section id="result-files">
<h3>Result Files<a class="headerlink" href="#result-files" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Used for saving a table of result parameters to various file formats.
For each of the valid formats (<code class="docutils literal notranslate"><span class="pre">txt</span></code>, <code class="docutils literal notranslate"><span class="pre">pdf</span></code>, and <code class="docutils literal notranslate"><span class="pre">csv</span></code>), the associated
tick-boxes are used for specifying whether or not to generate a file of that
format. Adjacent to each tick-box is an entry box for specifying the name of
the result file.</p>
<p>Finally, the <cite>Description</cite> box can be used to enter a description relating
to the estimation, which will be added to the result file(s).</p>
</div></blockquote>
</section>
<section id="estimator">
<h3>Estimator<a class="headerlink" href="#estimator" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Used for saving (<a class="reference external" href="https://docs.python.org/3/library/pickle.html">“pickling”</a>)
the <a class="reference internal" href="../../references/core.html#nmrespy.core.Estimator" title="nmrespy.core.Estimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">nmrespy.core.Estimator</span></code></a> class instance, associated with the
estimation result.</p>
<ul class="simple">
<li><p><cite>Save Estimator</cite> - Specifies whether or not to save the estimator to a
binary file.</p></li>
<li><p><cite>Filename</cite> - The filename to save the estimator to.</p></li>
</ul>
</div></blockquote>
</section>
<section id="directory">
<h3>Directory<a class="headerlink" href="#directory" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The entry box is used to specify the path to the directory to save <strong>all</strong>
specified files to. The full path can either be typed out manually, or
selected, by loading the file navigation window, by pressing the button
with a folder icon.</p>
</div></blockquote>
<p>Clicking <em>Save</em> will result in all the specified files to be saved to the desired
paths. The application will also be closed.</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Estimation Result</a><ul>
<li><a class="reference internal" href="#tweaking-and-re-optimising-the-result">Tweaking and Re-optimising the result</a><ul>
<li><a class="reference internal" href="#the-add-button">The Add Button</a></li>
<li><a class="reference internal" href="#the-remove-button">The Remove Button</a></li>
<li><a class="reference internal" href="#the-merge-button">The Merge Button</a></li>
<li><a class="reference internal" href="#the-split-button">The Split Button</a></li>
<li><a class="reference internal" href="#re-running-the-optimiser">Re-running the Optimiser</a></li>
<li><a class="reference internal" href="#undoing-changes">Undoing changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#saving-the-result">Saving the result</a><ul>
<li><a class="reference internal" href="#result-figure">Result Figure</a></li>
<li><a class="reference internal" href="#result-files">Result Files</a></li>
<li><a class="reference internal" href="#estimator">Estimator</a></li>
<li><a class="reference internal" href="#directory">Directory</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="setup.html"
                        title="previous chapter">Estimation Set-up</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../../references/index.html"
                        title="next chapter">Reference</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/gui/usage/result.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../references/index.html" title="Reference"
             >next</a> |</li>
        <li class="right" >
          <a href="setup.html" title="Estimation Set-up"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">NMR-EsPy  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >The NMR-EsPy GUI</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Using The GUI</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Estimation Result</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Simon Hulse &amp; Mohammadali Foroozandeh.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.2.
    </div>
  </body>
</html>