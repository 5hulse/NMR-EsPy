

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>nmrespy.write &#8212; NMR-EsPy  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bizstyle.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">NMR-EsPy  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">nmrespy.write</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for nmrespy.write</h1><div class="highlight"><pre>
<span></span><span class="c1"># write.py</span>
<span class="c1"># Simon Hulse</span>
<span class="c1"># simon.hulse@chem.ox.ac.uk</span>

<span class="sd">&quot;&quot;&quot;Writing estimation results to .txt, .pdf and .csv files&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">tempfile</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span> <span class="k">as</span> <span class="nn">slinalg</span>

<span class="kn">from</span> <span class="nn">nmrespy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">nmrespy._errors</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">nmrespy._misc</span> <span class="kn">import</span> <span class="n">ArgumentChecker</span><span class="p">,</span> <span class="n">PathManager</span><span class="p">,</span> <span class="n">significant_figures</span>

<span class="nb">print</span><span class="p">(</span><span class="n">GITHUBLINK</span><span class="p">)</span>

<div class="viewcode-block" id="write_result"><a class="viewcode-back" href="../../references/write.html#nmrespy.write.write_result">[docs]</a><span class="k">def</span> <span class="nf">write_result</span><span class="p">(</span>
    <span class="n">parameters</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./nmrespy_result&#39;</span><span class="p">,</span> <span class="n">sfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">integrals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">info_headings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sig_figs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">sci_lims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;txt&#39;</span><span class="p">,</span> <span class="n">force_overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pdflatex_exe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fprint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Writes an estimation result to a .txt, .pdf or .csv file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parameters : numpy.ndarray</span>
<span class="sd">        The estimated parameter array.</span>

<span class="sd">    errors : numpy.ndarray or None, default: None</span>
<span class="sd">        The errors associated with the parameters. If not `None`, the shape</span>
<span class="sd">        of `errors` should match that of `parameters`.</span>

<span class="sd">    path : str, default: &#39;./nmrespy_result&#39;</span>
<span class="sd">        The path to save the file to. DO NOT INCLUDE A FILE EXTENSION.</span>
<span class="sd">        This will be added based on the value of `fmt`. For example, if you</span>
<span class="sd">        set `path` to `.../result.txt` and `fmt` is `&#39;txt&#39;`, the resulting</span>
<span class="sd">        file will be `.../result.txt.txt`</span>

<span class="sd">    sfo : [float], [float, float] or None:</span>
<span class="sd">        The transmitter offset in each dimension. This is required to</span>
<span class="sd">        express frequencies in ppm as well as Hz. If `None`, frequencies</span>
<span class="sd">        will only be expressed in Hz.</span>

<span class="sd">    integrals : list or None</span>
<span class="sd">        Peak integrals of each oscillator. Note that</span>
<span class="sd">        ``parameters.shape[0] == len(integrals)`` should be satisfied.</span>

<span class="sd">    fmt : &#39;txt&#39;, &#39;pdf&#39; or &#39;csv&#39;, default: &#39;txt&#39;</span>
<span class="sd">        File format. See notes for details on system requirements for PDF</span>
<span class="sd">        generation.</span>

<span class="sd">    force_overwrite : bool. default: False</span>
<span class="sd">        Defines behaviour if ``f&#39;{path}.{fmt}&#39;`` already exists:</span>

<span class="sd">        * If `force_overwrite` is set to `False`, the user will be prompted</span>
<span class="sd">          if they are happy overwriting the current file.</span>
<span class="sd">        * If `force_overwrite` is set to `True`, the current file will be</span>
<span class="sd">          overwritten without prompt.</span>

<span class="sd">    description : str or None, default: None</span>
<span class="sd">        A descriptive statement.</span>

<span class="sd">    info_headings : list or None, default: None</span>
<span class="sd">        Headings for experiment information. Could include items like</span>
<span class="sd">        `&#39;Sweep width (Hz)&#39;`, `&#39;Transmitter offset (Hz)&#39;`, etc.</span>
<span class="sd">        N.B. All the elements in `info_headings` should be strings!</span>

<span class="sd">    info : list or None, default: None</span>
<span class="sd">        Information that corresponds to each heading in `info_headings`.</span>
<span class="sd">        N.B. All the elements in `info` should be strings!</span>

<span class="sd">    sig_figs : int or None default: 5</span>
<span class="sd">        The number of significant figures to give to parameter values. If</span>
<span class="sd">        `None`, the full value will be used.</span>

<span class="sd">    sci_lims : (int, int) or None, default: (-2, 3)</span>
<span class="sd">        Given a value ``(-x, y)``, for positive `x` and `y`, any parameter `p`</span>
<span class="sd">        value which satisfies ``p &lt; 10 ** -x`` or ``p &gt;= 10 ** y`` will be</span>
<span class="sd">        expressed in scientific notation, rather than explicit notation.</span>
<span class="sd">        If `None`, all values will be expressed explicitely.</span>

<span class="sd">    pdflatex_exe : str or None, default: None</span>
<span class="sd">        The path to the system&#39;s ``pdflatex`` executable.</span>

<span class="sd">        .. note::</span>

<span class="sd">           You are unlikely to need to set this manually. It is primarily</span>
<span class="sd">           present to specify the path to ``pdflatex.exe`` on Windows when</span>
<span class="sd">           the NMR-EsPy GUI has been loaded from TopSpin.</span>

<span class="sd">    fprint : bool, default: True</span>
<span class="sd">        Specifies whether or not to print information to the terminal.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    LaTeXFailedError</span>
<span class="sd">        With `fmt` set to `&#39;pdf&#39;`, this will be raised if an error</span>
<span class="sd">        was encountered in trying to run ``pdflatex``.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    To generate PDF result files, it is necessary to have a LaTeX installation</span>
<span class="sd">    set up on your system.</span>
<span class="sd">    For a simple to set up implementation that is supported on all</span>
<span class="sd">    major operating systems, consider</span>
<span class="sd">    `TexLive &lt;https://www.tug.org/texlive/&gt;`_. To ensure that</span>
<span class="sd">    you have a functioning LaTeX installation, open a command</span>
<span class="sd">    prompt/terminal and type:</span>

<span class="sd">    .. code::</span>

<span class="sd">       $ pdflatex -version</span>
<span class="sd">       pdfTeX 3.14159265-2.6-1.40.20 (TeX Live 2019/Debian)</span>
<span class="sd">       kpathsea version 6.3.1</span>
<span class="sd">       Copyright 2019 Han The Thanh (pdfTeX) et al.</span>
<span class="sd">       There is NO warranty.  Redistribution of this software is</span>
<span class="sd">       covered by the terms of both the pdfTeX copyright and</span>
<span class="sd">       the Lesser GNU General Public License.</span>
<span class="sd">       For more information about these matters, see the file</span>
<span class="sd">       named COPYING and the pdfTeX source.</span>
<span class="sd">       Primary author of pdfTeX: Han The Thanh (pdfTeX) et al.</span>
<span class="sd">       Compiled with libpng 1.6.37; using libpng 1.6.37</span>
<span class="sd">       Compiled with zlib 1.2.11; using zlib 1.2.11</span>
<span class="sd">       Compiled with xpdf version 4.01</span>

<span class="sd">    The following is a full list of packages that your LaTeX installation</span>
<span class="sd">    will need to successfully compile the generated .tex file:</span>

<span class="sd">    * `amsmath &lt;https://ctan.org/pkg/amsmath?lang=en&gt;`_</span>
<span class="sd">    * `array &lt;https://ctan.org/pkg/array?lang=en&gt;`_</span>
<span class="sd">    * `booktabs &lt;https://ctan.org/pkg/booktabs?lang=en&gt;`_</span>
<span class="sd">    * `cmbright &lt;https://ctan.org/pkg/cmbright&gt;`_</span>
<span class="sd">    * `geometry &lt;https://ctan.org/pkg/geometry&gt;`_</span>
<span class="sd">    * `hyperref &lt;https://ctan.org/pkg/hyperref?lang=en&gt;`_</span>
<span class="sd">    * `longtable &lt;https://ctan.org/pkg/longtable&gt;`_</span>
<span class="sd">    * `siunitx &lt;https://ctan.org/pkg/siunitx?lang=en&gt;`_</span>
<span class="sd">    * `tcolorbox &lt;https://ctan.org/pkg/tcolorbox?lang=en&gt;`_</span>
<span class="sd">    * `varwidth &lt;https://www.ctan.org/pkg/varwidth&gt;`_</span>
<span class="sd">    * `xcolor &lt;https://ctan.org/pkg/xcolor?lang=en&gt;`_</span>

<span class="sd">    If you wish to check the packages are available, use ``kpsewhich``:</span>

<span class="sd">    .. code::</span>

<span class="sd">        $ kpsewhich booktabs.sty</span>
<span class="sd">        /usr/share/texlive/texmf-dist/tex/latex/booktabs/booktabs.sty</span>

<span class="sd">    If a pathname appears, the package is installed to that path.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># --- Check validity of arguments ------------------------------------</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">parameters should be a numoy array</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>

    <span class="n">components</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="s1">&#39;parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;parameter&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="s1">&#39;str&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="s1">&#39;fmt&#39;</span><span class="p">,</span> <span class="s1">&#39;file_fmt&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">force_overwrite</span><span class="p">,</span> <span class="s1">&#39;force_overwrite&#39;</span><span class="p">,</span> <span class="s1">&#39;bool&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">fprint</span><span class="p">,</span> <span class="s1">&#39;fprint&#39;</span><span class="p">,</span> <span class="s1">&#39;bool&#39;</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">errors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">errors</span><span class="p">,</span> <span class="s1">&#39;errors&#39;</span><span class="p">,</span> <span class="s1">&#39;parameter&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">sfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sfo</span><span class="p">,</span> <span class="s1">&#39;sfo&#39;</span><span class="p">,</span> <span class="s1">&#39;float_list&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">description</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;str&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">info_headings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">info_headings</span><span class="p">,</span> <span class="s1">&#39;info_headings&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span><span class="p">))</span>
        <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">info</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">info_headings</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">info and info_headings should either both be lists&#39;</span>
            <span class="sa">f</span><span class="s1">&#39; of the same length, or both be None.</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">sig_figs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sig_figs</span><span class="p">,</span> <span class="s1">&#39;sig_figs&#39;</span><span class="p">,</span> <span class="s1">&#39;positive_int&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">sci_lims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sci_lims</span><span class="p">,</span> <span class="s1">&#39;sci_lims&#39;</span><span class="p">,</span> <span class="s1">&#39;pos_neg_tuple&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">integrals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">integrals</span><span class="p">,</span> <span class="s1">&#39;integrals&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span><span class="p">))</span>

    <span class="n">ArgumentChecker</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
    <span class="c1"># Should be same number of integrals as number of oscillators</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">integrals</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">integrals</span><span class="p">)</span> <span class="o">!=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">integrals should have the same number of elements as&#39;</span>
            <span class="sa">f</span><span class="s1">&#39; parameters.shape[0]</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
    <span class="c1"># info and info_headings should be the same length if lists</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">info_headings</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">info and info_headings should be the same&#39;</span>
            <span class="sa">f</span><span class="s1">&#39; length</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
    <span class="c1"># parameters and errors should be the same shape, if errors is not None</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">errors</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">`parameters` and `errors` should be the same&#39;</span>
            <span class="sa">f</span><span class="s1">&#39; shape</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>

    <span class="c1"># Get full path</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
    <span class="c1"># Append extension to file path</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;.</span><span class="si">{</span><span class="n">fmt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># Check path is valid (check directory exists, ask user if they are happy</span>
    <span class="c1"># overwriting if file already exists).</span>
    <span class="n">pathres</span> <span class="o">=</span> <span class="n">PathManager</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">check_file</span><span class="p">(</span><span class="n">force_overwrite</span><span class="p">)</span>
    <span class="c1"># Valid path, we are good to proceed</span>
    <span class="k">if</span> <span class="n">pathres</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1"># Overwrite denied by the user. Exit the program</span>
    <span class="k">elif</span> <span class="n">pathres</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">exit</span><span class="p">()</span>
    <span class="c1"># pathres == 2: Directory specified doesn&#39;t exist</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">The directory implied by path does not exist</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>

    <span class="c1"># Checking complete...</span>

    <span class="c1"># --- Construct nested list of components for parameter table --------</span>
    <span class="n">param_titles</span><span class="p">,</span> <span class="n">param_table</span> <span class="o">=</span> \
        <span class="n">_construct_paramtable</span><span class="p">(</span>
            <span class="n">parameters</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">integrals</span><span class="p">,</span> <span class="n">sfo</span><span class="p">,</span> <span class="n">sig_figs</span><span class="p">,</span> <span class="n">sci_lims</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># --- Write to the specified file type -------------------------------</span>
    <span class="k">if</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;txt&#39;</span><span class="p">:</span>
        <span class="n">_write_txt</span><span class="p">(</span>
            <span class="n">path</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">info_headings</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">param_titles</span><span class="p">,</span> <span class="n">param_table</span><span class="p">,</span>
            <span class="n">fprint</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;pdf&#39;</span><span class="p">:</span>
        <span class="n">_write_pdf</span><span class="p">(</span>
            <span class="n">path</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">info_headings</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">param_titles</span><span class="p">,</span> <span class="n">param_table</span><span class="p">,</span>
            <span class="n">pdflatex_exe</span><span class="p">,</span> <span class="n">fprint</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;csv&#39;</span><span class="p">:</span>
        <span class="n">_write_csv</span><span class="p">(</span>
            <span class="n">path</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">info_headings</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">param_titles</span><span class="p">,</span> <span class="n">param_table</span><span class="p">,</span>
            <span class="n">fprint</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="_write_txt"><a class="viewcode-back" href="../../references/write.html#nmrespy.write._write_txt">[docs]</a><span class="k">def</span> <span class="nf">_write_txt</span><span class="p">(</span>
    <span class="n">path</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">info_headings</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">param_titles</span><span class="p">,</span> <span class="n">param_table</span><span class="p">,</span> <span class="n">fprint</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes parameter estimate to a textfile.</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    path : pathlib.Path</span>
<span class="sd">        File path</span>

<span class="sd">    description : str or None, default: None</span>
<span class="sd">        A descriptive statement.</span>

<span class="sd">    info_headings : list or None, default: None</span>
<span class="sd">        Headings for experiment information.</span>

<span class="sd">    info : list or None, default: None</span>
<span class="sd">        Information that corresponds to each heading in `info_headings`.</span>

<span class="sd">    param_titles : list</span>
<span class="sd">        Titles for parameter array table.</span>

<span class="sd">    param_table : list</span>
<span class="sd">        Array of contents to append to the result table.</span>

<span class="sd">    fprint: bool</span>
<span class="sd">        Specifies whether or not to print output to terminal.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># --- Write header ---------------------------------------------------</span>
    <span class="c1"># Time and date</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">_timestamp</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="c1"># User-provided description</span>
    <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Description:</span><span class="se">\n</span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="c1"># Table of experiment information</span>
    <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Experiment Information:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="n">_txt_tabular</span><span class="p">([</span><span class="n">info_headings</span><span class="p">,</span> <span class="n">info</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="c1"># --- Add parameter table --------------------------------------------</span>
    <span class="c1"># Table of oscillator parameters</span>
    <span class="c1"># N.B. list(map(list, zip(*param_table))) effectively transposes the</span>
    <span class="c1"># list, which is given row-by-row. _txt_tabular takes a nested list</span>
    <span class="c1"># of columns as arguments.</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="n">_txt_tabular</span><span class="p">(</span>
        <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">param_table</span><span class="p">))),</span> <span class="n">titles</span><span class="o">=</span><span class="n">param_titles</span><span class="p">,</span>
        <span class="n">separator</span><span class="o">=</span><span class="s1">&#39;│&#39;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># --- Write footer ---------------------------------------------------</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Estimation performed using NMR-EsPy</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Author: Simon Hulse ~ simon.hulse@chem.ox.ac.uk</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;If used in any publications, please cite:</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;&lt;no papers yet...&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;For more information, visit the GitHub repo:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">msg</span> <span class="o">+=</span> <span class="n">GITHUBLINK</span>
    <span class="c1"># Save message to textfile</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fprint</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">G</span><span class="si">}</span><span class="s1">Saved result to </span><span class="si">{</span><span class="n">path</span><span class="si">}{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="_write_pdf"><a class="viewcode-back" href="../../references/write.html#nmrespy.write._write_pdf">[docs]</a><span class="k">def</span> <span class="nf">_write_pdf</span><span class="p">(</span>
    <span class="n">path</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">info_headings</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">param_titles</span><span class="p">,</span> <span class="n">param_table</span><span class="p">,</span>
    <span class="n">pdflatex_exe</span><span class="p">,</span> <span class="n">fprint</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Writes parameter estimate to a PDF using ``pdflatex``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    path : pathlib.Path</span>
<span class="sd">        File path</span>

<span class="sd">    description : str or None, default: None</span>
<span class="sd">        A descriptive statement.</span>

<span class="sd">    info_headings : list or None, default: None</span>
<span class="sd">        Headings for experiment information.</span>

<span class="sd">    info : list or None, default: None</span>
<span class="sd">        Information that corresponds to each heading in `info_headings`.</span>

<span class="sd">    param_titles : list</span>
<span class="sd">        Titles for parameter array table.</span>

<span class="sd">    param_table : list</span>
<span class="sd">        Array of contents to append to the result table.</span>

<span class="sd">    fprint: bool</span>
<span class="sd">        Specifies whether or not to print output to terminal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Open text of template .tex file which will be amended</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">NMRESPYPATH</span> <span class="o">/</span> <span class="s1">&#39;config/latex_template.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="c1"># Add image paths and weblinks to TeX document</span>
    <span class="c1"># If on Windows, have to replace paths of the form:</span>
    <span class="c1"># C:\a\b\c</span>
    <span class="c1"># to:</span>
    <span class="c1"># C:/a/b/c</span>
    <span class="n">patterns</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s1">&#39;&lt;MFLOGOPATH&gt;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;&lt;NMRESPYLOGOPATH&gt;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;&lt;DOCSLINK&gt;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;&lt;MFGROUPLINK&gt;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;&lt;BOOKICONPATH&gt;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;&lt;GITHUBLINK&gt;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;&lt;GITHUBLOGOPATH&gt;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;&lt;MAILTOLINK&gt;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;&lt;EMAILICONPATH&gt;&#39;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">paths</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">MFLOGOPATH</span><span class="p">,</span>
        <span class="n">NMRESPYLOGOPATH</span><span class="p">,</span>
        <span class="n">DOCSLINK</span><span class="p">,</span>
        <span class="n">MFGROUPLINK</span><span class="p">,</span>
        <span class="n">BOOKICONPATH</span><span class="p">,</span>
        <span class="n">GITHUBLINK</span><span class="p">,</span>
        <span class="n">GITHUBLOGOPATH</span><span class="p">,</span>
        <span class="n">MAILTOLINK</span><span class="p">,</span>
        <span class="n">EMAILICONPATH</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">path_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">patterns</span><span class="p">,</span> <span class="n">paths</span><span class="p">):</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">path_</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">))</span>

    <span class="c1"># Include a timestamp</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;TIMESTAMP&gt;&#39;</span><span class="p">,</span> <span class="n">_timestamp</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">&#39;</span><span class="p">))</span>

    <span class="c1"># --- Description ----------------------------------------------------</span>
    <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># No description given, remove relavent section of .tex file</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">% u</span><span class="s1">ser provided description</span><span class="se">\n\\</span><span class="s1">subsection*</span><span class="si">{Description}</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="s1">&#39;&lt;DESCRIPTION&gt;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;DESCRIPTION&gt;&#39;</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>

    <span class="c1"># --- Experiment Info ------------------------------------------------</span>
    <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># No info given, remove relavent section of .tex file</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="se">\n</span><span class="si">% e</span><span class="s1">xperiment parameters</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">subsection*{Experiment Information}</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">hspace{-6pt}</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">begin</span><span class="si">{tabular}{ll}</span><span class="se">\n</span><span class="s1">&lt;INFOTABLE&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">end</span><span class="si">{tabular}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Construct 2-column tabular of experiment info headings and values</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">info_headings</span><span class="p">,</span> <span class="n">info</span><span class="p">))</span>
        <span class="n">info_table</span> <span class="o">=</span> <span class="n">_latex_tabular</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;INFOTABLE&gt;&#39;</span><span class="p">,</span> <span class="n">info_table</span><span class="p">)</span>

    <span class="c1"># --- Parameter Table ------------------------------------------------</span>
    <span class="c1"># Determine number of columns required</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;COLUMNS&gt;&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_titles</span><span class="p">)</span> <span class="o">*</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="c1"># Construct parameter title and table body</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;PARAMTITLES&gt;&#39;</span><span class="p">,</span> <span class="n">_latex_tabular</span><span class="p">([</span><span class="n">param_titles</span><span class="p">]))</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;PARAMTABLE&gt;&#39;</span><span class="p">,</span> <span class="n">_latex_tabular</span><span class="p">(</span><span class="n">param_table</span><span class="p">))</span>

    <span class="c1"># Incude plus-minus symbol. For denoting errors.</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;±&quot;</span><span class="p">,</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">pm$ &quot;</span><span class="p">)</span>

    <span class="c1"># TODO support for including result figure</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="s1">&#39;</span><span class="si">% f</span><span class="s1">igure of result</span><span class="se">\n\\</span><span class="s1">begin</span><span class="si">{center}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">includegraphics{&lt;FIGURE_PATH&gt;}</span><span class="se">\n\\</span><span class="s1">end</span><span class="si">{center}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># --- Generate PDF using pdflatex ------------------------------------</span>
    <span class="c1"># Create required file paths:</span>
    <span class="c1"># .tex and .pdf paths with temporary directory (this is where the files</span>
    <span class="c1"># will be initially created)</span>
    <span class="c1"># .tex and .pdf files with desired directory (files will be moved from</span>
    <span class="c1"># temporary directory to desired directory once pdflatex is run).</span>
    <span class="n">tex_tmp_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">())</span> <span class="o">/</span> <span class="n">path</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.tex&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
    <span class="n">pdf_tmp_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">())</span> <span class="o">/</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span>
    <span class="n">tex_final_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.tex&#39;</span><span class="p">)</span>
    <span class="n">pdf_final_path</span> <span class="o">=</span> <span class="n">path</span>

    <span class="c1"># Write contents to cwd tex file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tex_tmp_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pdflatex_exe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pdflatex_exe</span> <span class="o">=</span> <span class="s2">&quot;pdflatex&quot;</span>
        <span class="c1"># -halt-on-error flag is vital. If any error arises in running</span>
        <span class="c1"># pdflatex, the program would get stuck</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="p">[</span><span class="n">pdflatex_exe</span><span class="p">,</span>
             <span class="s1">&#39;-halt-on-error&#39;</span><span class="p">,</span>
             <span class="sa">f</span><span class="s1">&#39;-output-directory=</span><span class="si">{</span><span class="n">tex_tmp_path</span><span class="o">.</span><span class="n">parent</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
             <span class="n">tex_tmp_path</span><span class="p">],</span>
            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span>
            <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Move pdf and tex files from temp directory to desired directory</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">tex_tmp_path</span><span class="p">,</span> <span class="n">tex_final_path</span><span class="p">)</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">pdf_tmp_path</span><span class="p">,</span> <span class="n">pdf_final_path</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">:</span>
        <span class="c1"># pdflatex came across an error</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">tex_tmp_path</span><span class="p">,</span> <span class="n">tex_final_path</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">LaTeXFailedError</span><span class="p">(</span><span class="n">tex_final_path</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="c1"># Most probably, pdflatex does not exist</span>
        <span class="k">raise</span> <span class="n">LaTeXFailedError</span><span class="p">(</span><span class="n">tex_final_path</span><span class="p">)</span>

    <span class="c1"># Remove other LaTeX files</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tex_tmp_path</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.out&#39;</span><span class="p">))</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tex_tmp_path</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.aux&#39;</span><span class="p">))</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tex_tmp_path</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.log&#39;</span><span class="p">))</span>

    <span class="c1"># # TODO: remove figure file if it exists</span>
    <span class="c1"># try:</span>
    <span class="c1">#     os.remove(figure_path)</span>
    <span class="c1"># except UnboundLocalError:</span>
    <span class="c1">#     pass</span>

    <span class="c1"># Print success message</span>
    <span class="k">if</span> <span class="n">fprint</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">G</span><span class="si">}</span><span class="s1">Result successfuly output to:</span><span class="se">\n</span><span class="s1">&#39;</span>
              <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pdf_final_path</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
              <span class="s1">&#39;If you wish to customise the document, the TeX file can&#39;</span>
              <span class="s1">&#39; be found at:</span><span class="se">\n</span><span class="s1">&#39;</span>
              <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">tex_final_path</span><span class="si">}{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="_write_csv"><a class="viewcode-back" href="../../references/write.html#nmrespy.write._write_csv">[docs]</a><span class="k">def</span> <span class="nf">_write_csv</span><span class="p">(</span>
    <span class="n">path</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">info_headings</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">param_titles</span><span class="p">,</span> <span class="n">param_table</span><span class="p">,</span>
    <span class="n">fprint</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Writes parameter estimate to a CSV.</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    path : pathlib.Path</span>
<span class="sd">        File path</span>

<span class="sd">    description : str or None, default: None</span>
<span class="sd">        A descriptive statement.</span>

<span class="sd">    info_headings : list or None, default: None</span>
<span class="sd">        Headings for experiment information.</span>

<span class="sd">    info : list or None, default: None</span>
<span class="sd">        Information that corresponds to each heading in `info_headings`.</span>

<span class="sd">    param_titles : list</span>
<span class="sd">        Titles for parameter array table.</span>

<span class="sd">    param_table : list</span>
<span class="sd">        Array of contents to append to the result table.</span>

<span class="sd">    fprint: bool</span>
<span class="sd">        Specifies whether or not to print output to terminal.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
        <span class="c1"># Timestamp</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="n">_timestamp</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)])</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([])</span>
        <span class="c1"># Description</span>
        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="s1">&#39;Description:&#39;</span><span class="p">,</span> <span class="n">description</span><span class="p">])</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([])</span>
        <span class="c1"># Experiment info</span>
        <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="s1">&#39;Experiment Info:&#39;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">info_headings</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([])</span>
        <span class="c1"># Parameter table</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="s1">&#39;Result:&#39;</span><span class="p">])</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">param_titles</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">param_table</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fprint</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">G</span><span class="si">}</span><span class="s1">Saved result to </span><span class="si">{</span><span class="n">path</span><span class="si">}{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="_map_to_latex_titles"><a class="viewcode-back" href="../../references/write.html#nmrespy.write._map_to_latex_titles">[docs]</a><span class="k">def</span> <span class="nf">_map_to_latex_titles</span><span class="p">(</span><span class="n">titles</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given a list of titles produced by :py:func:`_construct_paramtable`,</span>
<span class="sd">    Generate equivalent titles for LaTeX.</span>

<span class="sd">    Uses a simple literal matching approach.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">latex_titles</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">title</span> <span class="ow">in</span> <span class="n">titles</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Osc.&#39;</span><span class="p">:</span>
            <span class="n">latex_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$m$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Amp.&#39;</span><span class="p">:</span>
            <span class="n">latex_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$a_m$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Phase (rad)&#39;</span><span class="p">:</span>
            <span class="n">latex_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">phi_m</span><span class="se">\\</span><span class="s1"> (</span><span class="se">\\</span><span class="s1">text</span><span class="si">{rad}</span><span class="s1">)$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Freq. (Hz)&#39;</span><span class="p">:</span>
            <span class="n">latex_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$f_m</span><span class="se">\\</span><span class="s1"> (</span><span class="se">\\</span><span class="s1">text</span><span class="si">{Hz}</span><span class="s1">)$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Freq. (ppm)&#39;</span><span class="p">:</span>
            <span class="n">latex_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$f_m</span><span class="se">\\</span><span class="s1"> (</span><span class="se">\\</span><span class="s1">text</span><span class="si">{ppm}</span><span class="s1">)$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Freq. 1 (Hz)&#39;</span><span class="p">:</span>
            <span class="n">latex_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$f_{1,m}</span><span class="se">\\</span><span class="s1"> (</span><span class="se">\\</span><span class="s1">text</span><span class="si">{Hz}</span><span class="s1">)$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Freq. 1 (ppm)&#39;</span><span class="p">:</span>
            <span class="n">latex_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$f_{1,m}</span><span class="se">\\</span><span class="s1"> (</span><span class="se">\\</span><span class="s1">text</span><span class="si">{ppm}</span><span class="s1">)$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Freq. 2 (Hz)&#39;</span><span class="p">:</span>
            <span class="n">latex_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$f_{2,m}</span><span class="se">\\</span><span class="s1"> (</span><span class="se">\\</span><span class="s1">text</span><span class="si">{Hz}</span><span class="s1">)$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Freq. 2 (ppm)&#39;</span><span class="p">:</span>
            <span class="n">latex_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$f_{2,m}</span><span class="se">\\</span><span class="s1"> (</span><span class="se">\\</span><span class="s1">text</span><span class="si">{ppm}</span><span class="s1">)$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Damp. (s⁻¹)&#39;</span><span class="p">:</span>
            <span class="n">latex_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">eta_m</span><span class="se">\\</span><span class="s1"> (</span><span class="se">\\</span><span class="s1">text</span><span class="si">{s}</span><span class="s1">^{-1})$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Damp. 1 (s⁻¹)&#39;</span><span class="p">:</span>
            <span class="n">latex_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">eta_{1,m}</span><span class="se">\\</span><span class="s1"> (</span><span class="se">\\</span><span class="s1">text</span><span class="si">{s}</span><span class="s1">^{-1})$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Damp. 2 (s⁻¹)&#39;</span><span class="p">:</span>
            <span class="n">latex_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">eta_{2,m}</span><span class="se">\\</span><span class="s1"> (</span><span class="se">\\</span><span class="s1">text</span><span class="si">{s}</span><span class="s1">^{-1})$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Integ.&#39;</span><span class="p">:</span>
            <span class="n">latex_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">int$&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;Norm. Integ.&#39;</span><span class="p">:</span>
            <span class="n">latex_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nicefrac{</span><span class="se">\\</span><span class="s1">int}{</span><span class="se">\\</span><span class="s1">left</span><span class="se">\\</span><span class="s1">lVert</span><span class="se">\\</span><span class="s1">int</span><span class="se">\\</span><span class="s1">right</span><span class="se">\\</span><span class="s1">rVert}$&#39;</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">latex_titles</span></div>


<div class="viewcode-block" id="_construct_paramtable"><a class="viewcode-back" href="../../references/write.html#nmrespy.write._construct_paramtable">[docs]</a><span class="k">def</span> <span class="nf">_construct_paramtable</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">integrals</span><span class="p">,</span> <span class="n">sfo</span><span class="p">,</span> <span class="n">sig_figs</span><span class="p">,</span>
                          <span class="n">sci_lims</span><span class="p">,</span> <span class="n">fmt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a nested list of values to input to parameter table, with</span>
<span class="sd">    desired formatting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    parameters : numpy.ndarray</span>
<span class="sd">        Parameter array.</span>

<span class="sd">    errors : numpy.ndarray or None</span>
<span class="sd">        Parameter errors.</span>

<span class="sd">    integrals : list</span>
<span class="sd">        Oscillator peak integrals.</span>

<span class="sd">    sfo : [float], or [float, float] or None</span>
<span class="sd">        Transmitter offset frequency (MHz) in each dimension.</span>

<span class="sd">    sig_figs : int or None</span>
<span class="sd">        Desired nuber of significant figures.</span>

<span class="sd">    sci_lims : (int, int) or None</span>
<span class="sd">        Bounds defining thresholds for using scientific notation.</span>

<span class="sd">    Returns</span>
<span class="sd">    --------</span>
<span class="sd">    titles : list</span>
<span class="sd">        Titles of parameter table</span>

<span class="sd">    table : list</span>
<span class="sd">        Values of parameter table.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">M</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="c1"># --- Create titles for parameter table ------------------------------</span>
    <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Osc.&#39;</span><span class="p">,</span> <span class="s1">&#39;Amp.&#39;</span><span class="p">,</span> <span class="s1">&#39;Phase (rad)&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">titles</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Freq. (Hz)&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">titles</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Freq. (ppm)&#39;</span><span class="p">]</span>
        <span class="n">titles</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Damp. (s⁻¹)&#39;</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">titles</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Freq. 1 (Hz)&#39;</span><span class="p">,</span> <span class="s1">&#39;Freq. 2 (Hz)&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">titles</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Freq. 1 (ppm)&#39;</span><span class="p">,</span> <span class="s1">&#39;Freq. 2 (ppm)&#39;</span><span class="p">]</span>
        <span class="n">titles</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Damp. 1 (s⁻¹)&#39;</span><span class="p">,</span> <span class="s1">&#39;Damp. 2 (s⁻¹)&#39;</span><span class="p">]</span>

    <span class="n">table</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Norm of integrals</span>
    <span class="k">if</span> <span class="n">integrals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">titles</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;Integ.&#39;</span><span class="p">,</span> <span class="s1">&#39;Norm. Integ.&#39;</span><span class="p">]</span>
        <span class="n">norm_integrals</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">integrals</span><span class="p">)</span> <span class="o">/</span> <span class="n">slinalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">integrals</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;pdf&#39;</span><span class="p">:</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="n">_map_to_latex_titles</span><span class="p">(</span><span class="n">titles</span><span class="p">)</span>

    <span class="c1"># --- Generate string representations of parameter values ------------</span>

    <span class="c1"># Shorthand function</span>
    <span class="k">def</span> <span class="nf">_mystr</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_strval</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">sig_figs</span><span class="p">,</span> <span class="n">sci_lims</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="c1"># Construct rows of table (each row corresponds to one oscillator)</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Oscillator number</span>
        <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># Amplitude</span>
        <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_mystr</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
        <span class="c1"># Phase</span>
        <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_mystr</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
        <span class="c1"># Frequencies</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dim</span><span class="p">):</span>
            <span class="c1"># Hz</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_mystr</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">]))</span>
            <span class="c1"># ppm (if sfo provided)</span>
            <span class="k">if</span> <span class="n">sfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_mystr</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">sfo</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]))</span>
        <span class="c1"># Damping</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dim</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dim</span><span class="p">):</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_mystr</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">integrals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Integrals</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_mystr</span><span class="p">(</span><span class="n">integrals</span><span class="p">[</span><span class="n">m</span><span class="p">]))</span>
            <span class="c1"># Normalised integrals</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_mystr</span><span class="p">(</span><span class="n">norm_integrals</span><span class="p">[</span><span class="n">m</span><span class="p">]))</span>
        <span class="c1"># Add row to table</span>
        <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">errors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># first element is blank entry for oscillator column</span>
            <span class="n">err_row</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
            <span class="c1"># Amplitude</span>
            <span class="n">err_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;±&quot;</span> <span class="o">+</span> <span class="n">_mystr</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
            <span class="c1"># Phase</span>
            <span class="n">err_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;±&quot;</span> <span class="o">+</span> <span class="n">_mystr</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
            <span class="c1"># Frequencies</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dim</span><span class="p">):</span>
                <span class="c1"># Hz</span>
                <span class="n">err_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;±&quot;</span> <span class="o">+</span> <span class="n">_mystr</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">]))</span>
                <span class="c1"># ppm (if sfo provided)</span>
                <span class="k">if</span> <span class="n">sfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">err_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;±&quot;</span> <span class="o">+</span> <span class="n">_mystr</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">sfo</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]))</span>
            <span class="c1"># Damping</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dim</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dim</span><span class="p">):</span>
                <span class="n">err_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;±&quot;</span> <span class="o">+</span> <span class="n">_mystr</span><span class="p">(</span><span class="n">errors</span><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">]))</span>

            <span class="c1"># TODO: Integral errors</span>
            <span class="k">if</span> <span class="n">integrals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">err_row</span> <span class="o">=</span> <span class="n">err_row</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">]</span>
            <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">err_row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">titles</span><span class="p">,</span> <span class="n">table</span></div>


<div class="viewcode-block" id="_timestamp"><a class="viewcode-back" href="../../references/write.html#nmrespy.write._timestamp">[docs]</a><span class="k">def</span> <span class="nf">_timestamp</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Constructs a string with time/date information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    timestamp : str</span>
<span class="sd">        Of the form:</span>

<span class="sd">        .. code::</span>

<span class="sd">           hh:mm:ss</span>
<span class="sd">           dd-mm-yy</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># Day</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m&#39;</span><span class="p">)</span>  <span class="c1"># Month</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span>  <span class="c1"># Year</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%X</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># Time (hh:mm:ss)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span></div>


<div class="viewcode-block" id="_strval"><a class="viewcode-back" href="../../references/write.html#nmrespy.write._strval">[docs]</a><span class="k">def</span> <span class="nf">_strval</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">sig_figs</span><span class="p">,</span> <span class="n">sci_lims</span><span class="p">,</span> <span class="n">fmt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert float to formatted string.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    value - float</span>
<span class="sd">        Value to convert.</span>

<span class="sd">    sig_figs - int or None</span>
<span class="sd">        Number of significant figures.</span>

<span class="sd">    sci_lims - (int, int) or None</span>
<span class="sd">        Bounds defining thresholds for using scientific notation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    strval - str</span>
<span class="sd">        Formatted value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set to correct number of significant figures</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sig_figs</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">significant_figures</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">sig_figs</span><span class="p">)</span>
    <span class="c1"># Determine whether to express the value in scientific notation or not</span>
    <span class="k">return</span> <span class="n">_scientific_notation</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">sci_lims</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span></div>


<div class="viewcode-block" id="_scientific_notation"><a class="viewcode-back" href="../../references/write.html#nmrespy.write._scientific_notation">[docs]</a><span class="k">def</span> <span class="nf">_scientific_notation</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">sci_lims</span><span class="p">,</span> <span class="n">fmt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts value to scientific notation</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    value : float</span>
<span class="sd">        Value to process</span>

<span class="sd">    sci_lims : (int, int)</span>
<span class="sd">        See description in :py:func:`write_result`</span>

<span class="sd">    fmt : &#39;txt&#39;, &#39;pdf&#39;, or &#39;csv&#39;</span>
<span class="sd">        File format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If user speicifed to never user scientific notation, or the value</span>
    <span class="c1"># does not have a sufficiently high exponent, or the file type is a csv,</span>
    <span class="c1"># simply return the value unedited, as a string.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">sci_lims</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
            <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">sci_lims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span>
             <span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">sci_lims</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="ow">or</span>
            <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;csv&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="c1"># Convert to scientific notation</span>
    <span class="c1"># Regex is used to remove any trailing zeros, ie:</span>
    <span class="c1"># 12345000e8 -&gt; 12345e8</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
        <span class="sa">r</span><span class="s1">&#39;0+e&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;+0&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-0&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;txt&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">value</span>
    <span class="c1"># For LaTeX, convert to \num{value}</span>
    <span class="c1"># This is a siunitx macro which takes a value of the form</span>
    <span class="c1"># 1234e5 and converts to 1234x10⁵</span>
    <span class="k">elif</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;pdf&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">num</span><span class="se">{{</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="se">}}</span><span class="s1">&#39;</span></div>


<div class="viewcode-block" id="_txt_tabular"><a class="viewcode-back" href="../../references/write.html#nmrespy.write._txt_tabular">[docs]</a><span class="k">def</span> <span class="nf">_txt_tabular</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tabularises a list of lists, with the option of including titles.</span>
<span class="sd">    Used in textfile outputs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    columns : list</span>
<span class="sd">        A list of lists, with each sublist representing the columns of the</span>
<span class="sd">        table. Each list must be of the same length.</span>

<span class="sd">    titles : None or list, default: None</span>
<span class="sd">        Titles for the table. If desired, `titles` should be of the same</span>
<span class="sd">        length as all of the sublists in `columns`.</span>

<span class="sd">    separator : str, default: &#39;&#39;</span>
<span class="sd">        Column separator. By default, an empty string is used. (See first</span>
<span class="sd">        example above).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    table : str</span>
<span class="sd">        A string with the contents of `titles` (opt.) and `columns`</span>
<span class="sd">        tabularised.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    A simple example with `titles` specified and the default `separator`:</span>

<span class="sd">    .. code:: python3</span>

<span class="sd">       &gt;&gt;&gt; from nmrespy.write import _txt_tabular</span>
<span class="sd">       &gt;&gt;&gt; columns = [[&#39;A1&#39;, &#39;B1&#39;], [&#39;A2&#39;, &#39;B2&#39;], [&#39;A3&#39;, &#39;B3&#39;]]</span>
<span class="sd">       &gt;&gt;&gt; titles = [&#39;title 1&#39;, &#39;title 2&#39;, &#39;title 3&#39;]</span>
<span class="sd">       &gt;&gt;&gt; print(_txt_tabular(columns, titles=titles))</span>
<span class="sd">       title 1  title 2  title 3</span>
<span class="sd">       ────────┼────────┼────────</span>
<span class="sd">       A1       A2       A3</span>
<span class="sd">       B1       B2       B3</span>

<span class="sd">    You may want to set `separator` to something like ``&#39;│&#39;``</span>
<span class="sd">    in order for a nicer layout when you have titles:</span>

<span class="sd">    .. code:: python3</span>

<span class="sd">       &gt;&gt;&gt; # Same as before...</span>
<span class="sd">       &gt;&gt;&gt; print(_txt_tabular(columns, titles=titles, separator=&#39;│&#39;))</span>
<span class="sd">       title 1 │title 2 │title 3</span>
<span class="sd">       ────────┼────────┼────────</span>
<span class="sd">       A1      │A2      │A3</span>
<span class="sd">       B1      │B2      │B3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If titles are given, append to the top of each column</span>
    <span class="k">if</span> <span class="n">titles</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">titles</span><span class="p">,</span> <span class="n">columns</span><span class="p">)):</span>
            <span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">title</span><span class="p">]</span> <span class="o">+</span> <span class="n">column</span>
    <span class="c1"># --- Determine width of each column ---------------------------------</span>
    <span class="n">pads</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="c1"># For each column find the longest string, and set its length</span>
        <span class="c1"># as the width</span>
        <span class="n">pads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">element</span><span class="p">))</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">column</span><span class="p">))</span>

    <span class="c1"># --- Construct table ------------------------------------------------</span>
    <span class="n">table</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="c1"># Iterate of rows (transpose array)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">columns</span><span class="p">)):</span>
        <span class="c1"># Iterate over each adjacent pair of elements in row</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="n">pad</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pads</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">:])):</span>
            <span class="c1"># Determine amount of padding between pair</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">pad</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="c1"># First element -&gt; don&#39;t want any padding before it.</span>
            <span class="c1"># All other elements are padded from the left.</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Case for first pairing in row</span>
                <span class="n">table</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">e1</span><span class="si">}{</span><span class="n">p</span><span class="o">*</span><span class="s1">&#39; &#39;</span><span class="si">}{</span><span class="n">separator</span><span class="si">}{</span><span class="n">e2</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">table</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p</span><span class="o">*</span><span class="s1">&#39; &#39;</span><span class="si">}{</span><span class="n">separator</span><span class="si">}{</span><span class="n">e2</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="c1"># Add newline character at end of row</span>
        <span class="n">table</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1"># At end of the first row, check if titles were given</span>
        <span class="c1"># If so, add a horizontal line underneath to separate the titles</span>
        <span class="c1"># from the other contents</span>
        <span class="k">if</span> <span class="n">titles</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">pad</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pads</span><span class="p">):</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">pad</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="c1"># Add a bar that looks like this: &#39;────────┼&#39;</span>
                <span class="n">table</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p</span><span class="o">*</span><span class="s1">&#39;─&#39;</span><span class="si">}</span><span class="s2">┼&quot;</span>
            <span class="c1"># Once the bar has been completed, remove the trailing &#39;┼&#39;</span>
            <span class="c1"># and add a newline</span>
            <span class="n">table</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">table</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="k">return</span> <span class="n">table</span></div>


<div class="viewcode-block" id="_latex_tabular"><a class="viewcode-back" href="../../references/write.html#nmrespy.write._latex_tabular">[docs]</a><span class="k">def</span> <span class="nf">_latex_tabular</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a string of text that denotes a tabular entity in LaTeX</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rows : list</span>
<span class="sd">        Nested list, with each sublist containing elements of a single row</span>
<span class="sd">        of the table.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    table : str</span>
<span class="sd">        LaTeX-formated table</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    .. code:: python3</span>

<span class="sd">       &gt;&gt;&gt; from nmrespy.write import _latex_tabular</span>
<span class="sd">       &gt;&gt;&gt; rows = [[&#39;A1&#39;, &#39;A2&#39;, &#39;A3&#39;], [&#39;B1&#39;, &#39;B2&#39;, &#39;B3&#39;]]</span>
<span class="sd">       &gt;&gt;&gt; print(_latex_tabular(rows))</span>
<span class="sd">       A1 &amp; A2 &amp; A3 \\\\</span>
<span class="sd">       B1 &amp; B2 &amp; B3 \\\\</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="n">table</span> <span class="o">+=</span> <span class="s1">&#39; &amp; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">row</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\\\\\n</span><span class="s1">&#39;</span>
    <span class="k">return</span> <span class="n">table</span></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">NMR-EsPy  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">nmrespy.write</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Simon Hulse &amp; Mohammadali Foroozandeh.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.3.
    </div>
  </body>
</html>